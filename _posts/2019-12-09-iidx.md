---
layout: post
title:  "第一回・弐寺モバイルでPCのキーボードを使う実験"
excerpt: "弐寺モバイル今すぐダウンロード"
date:   2019-12-09 21:00:00 +0900
---

ついに[弐寺モバイル](https://p.eagate.573.jp/game/2dx/mobile/top/)が遊べるようになりました。

で、早速ダウンロードしたんですが、流石にスマホの画面をタップでは厳しすぎます。

iOS版で遊んでいた知人がBluetooth経由で「beatmaniaIIDX専用コントローラ エントリーモデルが使用できるようになります」というスクショをシェアしていたので、本当ならそれが良いんでしょうが、あいにく僕は専コンも持っていないし、そもそもAndroid版を見るにそういう設定項目は無さそう…。(追記: 公式サイトの[ヘルプ](https://p.eagate.573.jp/game/2dx/mobile/help/)を見るとAndroidでもBluetoothで専コンと繋がる模様)

もしかしたらUSBキーボードやコントローラを繋いだら使えるかもしれないけど、僕のスマホはMicroUSBの端子で、それに繋がるような機器は持ってない。

とはいえ、PCと繋ぐUSBケーブルはある。ということで、自力でなんとかしましょう。

まずadbを入れます。

```sh
brew cask install android-platform-tools
```

で、スマホをUSBデバッグモードでPCと繋ぎ、弐寺モバイルを起動します。適当な曲を選曲した上で `adb shell` して `getevent` コマンドを実行します。

画面をタップするとそれに応じたイベントデータが吐かれるので、それをメモっときます。

で、各鍵盤とターンテーブルを押すイベントデータが取れたら、それを元に `sendevent` すればイベントをPCから発火させることができるはずです。

…という考えを元にちょっとだけコードを書いたのでリポジトリを作りました。

[511V41/iidx-mobile-keyboard](https://github.com/511V41/iidx-mobile-keyboard)

使い方は簡単で、各イベントデータさえ取ってもらえれば実行できるようになっています。僕の手元の環境だと、多少ラグはありますが押せないことはないようです。

しかしやってみればわかりますが、この手口だと連打が不安定だったり、同時押しに難があります。

なのでAndroidのイベントについてもっと詳しくなる必要がありますね。

ということで続きは次回。いつになるかはわかりませんが…。
